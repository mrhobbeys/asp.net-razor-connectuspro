@model SiteBlue.Areas.OwnerPortal.Models.CustomerDetail
@{
    ViewBag.Title = "CustomerInformation";
}

<!DOCTYPE html>
<html>
<head>
    <title>CustomerInformation</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <link href="../../../../Content/Tablestyle.css" rel="Stylesheet" type="text/css" />    
    <link href="../../../../codebase/skins/dhtmlxgrid_dhx_skyblue.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../Content/Report.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../Content/Site.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../codebase/dhtmlxgrid.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../codebase/skins/dhtmlxgrid_dhx_skyblue.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../Content/Site.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../codebase/dhtmlxgrid_pgn_bricks.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../codebase/dhtmlxtabbar.css" rel="Stylesheet" type="text/css" />    
    <link href="../../../../codebase/dhtmlxgrid_pgn_bricks.css" rel="Stylesheet" type="text/css" />
    <link href="../../../../codebase/skins/dhtmlxcalendar_dhx_skyblue.css" rel="stylesheet" type="text/css" />
    <link href="../../../../codebase/dhtmlxcalendar.css" rel="stylesheet" type="text/css" />
    <link href="../../../../../../common/favicon.ico" rel="icon" type="image/x-icon" />
    <link href="../../../../../../common/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="../../../../../../common/css/style.css" rel="Stylesheet" type="text/css" media="screen" />

    <script src="../../../../codebase/dhtmlxcommon.js" type="text/javascript"></script>
    <script src="../../../../content/json2.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxgrid.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxgridcell.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxgrid_excell_link.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxwindows.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxcontainer.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxcalendar.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxgrid_pgn.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxtabbar.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxtabbar_start.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxgrid_pgn.js" type="text/javascript"></script>
    <script src="../../../../codebase/dhtmlxgrid_srnd.js" type="text/javascript"></script>

    <script type="text/javascript">
        dhtmlx.skin = "dhx_skyblue";
    </script>
    <script src="../../../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
    <!-- dhtmlxGrid -->

    <style type="text/css">
        body
        {
            background-color: #dfedf3;
        }
    </style>

    <script type="text/javascript">

        $(document).ready(function () {

            $("#savebutton").click(function () {
                var CustName = $("#Name").val();
                var Address = $("#Address").val();
                var ComName = $("#ComName").val();
                var City = $("#City").val();
                var State = $("#State").val();
                var ZipCode = $("#ZipCode").val();
                var PhoneNumber = $("#PhoneNumber").val();
                var CellNumber = $("#CellNumber").val();
                var Email = $("#Email").val();
                var Notes = $("#GeneralNotes").val();
                var MemberType = $("#MemberType").val();
                var StartDate = $("#StartDate").val();
                var ExpiryDate = $("#ExpiryDate").val();
                var ServiceVisits = $("#ServiceVisits").val();
                var CCExpiryDate = $("#CCExpiryDate").val();
                var DateNextJob = $("#DateNextJob").val();
                var DateLastJob = $("#DateLastJob").val();
                var TotalJobs = $("#TotalJobs").val();
                var Balance = $("#CurrentBalance").val();
                var AgeofHome = $("#AgeofHome").val();
                var AgeofSystem = $("#AgeofSystem").val();
                var AgeofHeater = $("#AgeofHeater").val();
                var BCustName = $("#BName").val();
                var BAddress = $("#BAddress").val();
                var BComName = $("#BCompany").val();
                var BCity = $("#BCity").val();
                var BState = $("#BState").val();
                var BZipCode = $("#BPostal").val();
                var ServiceStatus = $("#ddlServiceStatus").val();

                if (MemberType != "") {
                    if (StartDate == "" || ExpiryDate == "") {
                        alert("Input the StartDate and ExpiryDate!");
                        return;
                    }

                    var date1 = new Date(StartDate);
                    var date2 = new Date(ExpiryDate);

                    if (date1 > date2) {
                        alert("StartDate should be less than ExpiryDate!");
                        return;
                    }
                }

                if (ZipCode != "") {
                    if (!validateZipCode(ZipCode)) {
                        alert("Please Enter ZipCode in #####-#### Format");
                        $("#ZipCode").focus();
                        return;
                    }
                }

                if (BZipCode != "") {
                    if (!validateZipCode(BZipCode)) {
                        alert("Please Enter Postal Code in #####-#### Format");
                        $("#BPostal").focus();
                        return;
                    }
                }

                if (State != "" && State.length != 2) {
                    alert("Please Input State Correctly!");
                    $("#State").focus();
                    return;
                }

                if (BState != "" && BState.length != 2) {
                    alert("Please Input State Correctly!");
                    $("#BState").focus();
                    return;
                }

                if (City != "" && City.length > 50) {
                    alert("Please Input City Correctly!");
                    $("#City").focus();
                    return;
                }

                if (PhoneNumber != "") {
                    if (!validatePhoneNumber(PhoneNumber)) {
                        alert("Please Enter Primary Phone Number in (###) ###-#### Format");
                        $("#PhoneNumber").focus();
                        return;
                    }
                }

                if (CellNumber != "") {
                    if (!validatePhoneNumber(CellNumber)) {
                        alert("Please Enter Cell Phone Number in (###) ###-#### Format");
                        $("#CellNumber").focus();
                        return;
                    }
                }

                if (Email != "") {
                    if (!validateEmail(Email)) {
                        alert("Please Enter Email Correctly");
                        $("#Email").focus();
                        return;
                    }
                }

                var params = {
                    CustName: CustName,
                    Address: Address,
                    ComName: ComName,
                    City: City,
                    State: State,
                    ZipCode: ZipCode,
                    PhoneNumber: PhoneNumber,
                    CellNumber: CellNumber,
                    Email: Email,
                    Notes: Notes,
                    MemberType: MemberType,
                    StartDate: StartDate,
                    ExpiryDate: ExpiryDate,
                    ServiceVisits: ServiceVisits,
                    CCExpiryDate: CCExpiryDate,
                    DateNextJob: DateNextJob,
                    DateLastJob: DateLastJob,
                    TotalJobs: TotalJobs,
                    Balance: Balance,
                    AgeofHome: AgeofHome,
                    AgeofSystem: AgeofSystem,
                    AgeofHeater: AgeofHeater,
                    BCustName: BCustName,
                    BComName: BComName,
                    BAddress: BAddress,
                    BCity: BCity,
                    BState: BState,
                    BZipCode: BZipCode,
                    ServiceStatus: ServiceStatus, 
                    CustID : '@Model.CustomerID' 
                };

                $("#savebutton").after('<img id="loadingimg" src="../../../../Images/ajax-loader.gif" alt="processing..." />');
                $("#savebutton").attr("disabled", "disabled");

                $.ajax({
                    type: "POST",
                    url: "/AllCustomers/SaveCustomerInformation",
                    data: JSON.stringify(params),
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        alert("Record has been updated");
                        window.location.reload();
                    },
                    error: function (e) {
                        $("#loadingimg").remove();
                        $("#savebutton").removeAttr("disabled");

                        alert("Update failed!");
                    }
                });
            });

            $("#editbutton").click(function () {
                document.getElementById("savebutton").style.display = 'block';
                document.getElementById("cancelbutton").style.display = 'block';
                document.getElementById("editbutton").style.display = 'none';

                $("#Name").removeAttr("readonly");
                $("#ComName").removeAttr("readonly");
                $("#Address").removeAttr("readonly");
                $("#City").removeAttr("readonly");
                $("#State").removeAttr("readonly");
                $("#ZipCode").removeAttr("readonly");

                $("#PhoneNumber").removeAttr("readonly");
                $("#CellNumber").removeAttr("readonly");
                $("#Email").removeAttr("readonly");
                $("#GeneralNotes").removeAttr("readonly");

                $("#BName").removeAttr("readonly");
                $("#BAddress").removeAttr("readonly");
                $("#BCompany").removeAttr("readonly");
                $("#BCity").removeAttr("readonly");
                $("#BState").removeAttr("readonly");
                $("#BPostal").removeAttr("readonly");

                $("#MemberType").removeAttr("readonly");
                $("#MemberType").removeAttr("disabled");

                if (document.getElementById("MemberType").value != '') {
                    $("#StartDate").removeAttr("readonly");
                    $("#StartDate").removeAttr("disabled");
                    $("#ExpiryDate").removeAttr("readonly");
                    $("#ExpiryDate").removeAttr("disabled");
                    $("#CCExpiryDate").removeAttr("readonly");
                    $("#CCExpiryDate").removeAttr("disabled");
                }
            });

            $("#cancelbutton").click(function () {
                document.getElementById("savebutton").style.display = 'none';
                document.getElementById("cancelbutton").style.display = 'none';
                document.getElementById("editbutton").style.display = 'block';


                document.getElementById("Name").setAttribute("readonly", "true");
                document.getElementById("ComName").setAttribute("readonly", "true");
                document.getElementById("PhoneNumber").setAttribute("readonly", "true");
                document.getElementById("CellNumber").setAttribute("readonly", "true");
                document.getElementById("Email").setAttribute("readonly", "true");
                document.getElementById("GeneralNotes").setAttribute("readonly", "true");

                document.getElementById("Address").setAttribute("readonly", "true");
                document.getElementById("City").setAttribute("readonly", "true");
                document.getElementById("State").setAttribute("readonly", "true");
                document.getElementById("ZipCode").setAttribute("readonly", "true");


                document.getElementById("MemberType").setAttribute("readonly", "true");
                document.getElementById("MemberType").setAttribute("disabled", "true");
                document.getElementById("StartDate").setAttribute("readonly", "true");
                document.getElementById("StartDate").setAttribute("disabled", "true");
                document.getElementById("ExpiryDate").setAttribute("readonly", "true");
                document.getElementById("ExpiryDate").setAttribute("disabled", "true");
                document.getElementById("ServiceVisits").setAttribute("readonly", "true");
                document.getElementById("CCExpiryDate").setAttribute("readonly", "true");
                document.getElementById("CCExpiryDate").setAttribute("disabled", "true");

                document.getElementById("BName").setAttribute("readonly", "true");
                document.getElementById("BAddress").setAttribute("readonly", "true");
                document.getElementById("BCompany").setAttribute("readonly", "true");
                document.getElementById("BCity").setAttribute("readonly", "true");
                document.getElementById("BState").setAttribute("readonly", "true");
                document.getElementById("BPostal").setAttribute("readonly", "true");

                document.getElementById("AgeofHome").setAttribute("readonly", "true");
                document.getElementById("AgeofSystem").setAttribute("readonly", "true");
                document.getElementById("AgeofHeater").setAttribute("readonly", "true");

                document.getElementById("DateNextJob").setAttribute("readonly", "true");
                document.getElementById("DateLastJob").setAttribute("readonly", "true");
                document.getElementById("TotalJobs").setAttribute("readonly", "true");
                document.getElementById("CurrentBalance").setAttribute("readonly", "true");
            });

            $('div[tab_id="customerhistory"]').live('click', function (event) {
                initCustomerHistoryGrid();
                BindCustomerHistory('@Model.CustomerID');
            });

            $("#MemberType").focus(function () {
                //previous = this.value;
                //alert("Focus:" + previous);
            }).change(function () {
                var change = confirm("You are about to change the service plan.  Do you wish to proceed with change?");
                if (change == true) {
                    if (document.getElementById("MemberType").value != '') {
                        $("#StartDate").removeAttr("readonly");
                        $("#StartDate").removeAttr("disabled");
                        $("#ExpiryDate").removeAttr("readonly");
                        $("#ExpiryDate").removeAttr("disabled");
                        //$("#ServiceVisits").removeAttr("readonly");
                        $("#CCExpiryDate").removeAttr("readonly");
                        $("#CCExpiryDate").removeAttr("disabled");
                    }
                } else {
                    document.getElementById("MemberType").value = previous;
                }
            });

            BindCalendar();
        });

        function BindCalendar() {
            myCalendar = new dhtmlXCalendarObject(["StartDate", "ExpiryDate", "CCExpiryDate", "DateNextJob", "DateLastJob"]);
            myCalendar.setWeekStartDay(7);
            myCalendar.setDateFormat("%m/%d/%Y");
        }

        function validatePhoneNumber(elementValue) {
            var phoneNumberPattern = /^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/;
            return phoneNumberPattern.test(elementValue);
        }

        function validateEmail(elementValue) {
            var filter = /^(([^<>()[\]\\.,;:\s@@\"]+(\.[^<>()[\]\\.,;:\s@@\"]+)*)|(\".+\"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return filter.test(elementValue);
        }

        function validateZipCode(elementValue) {
            var zipCodePattern = /^\d{5}$|^\d{5}-\d{4}$/;
            return zipCodePattern.test(elementValue);
        }

        function RowClick(rId, cInd) {
            var cellObj = gridEmpList.cellById(rId, 0);
            window.location.href = "../invoice/invoicedetails?JobId=" + cellObj.getValue();
        }

        function doOnLoad() {
            var custid = $("#hdnCustId").val();

            var params = { CustomerId: custid };
            gridEmpList = new dhtmlXGridObject("grdInvoiceNumbers");
            gridEmpList.setHeader("Invoice Number,Date");
            gridEmpList.setColTypes("ro,ro");
            gridEmpList.setInitWidthsP("48,48");
            gridEmpList.attachEvent("onRowSelect", "RowClick");
            gridEmpList.init();
            gridEmpList.setSkin("dhx_skyblue");

            var jsondata = $.ajax({
                url: "/AllCustomers/BindInvoiceNumbers",
                data: JSON.stringify(params),
                contentType: "application/json; charset=utf-8",
                success: function (result) {

                    var xmlstringEmpList = "<rows>";
                    $.each(result, function (index, Job) {
                        xmlstringEmpList += "<row id='" + index + "'>";
                        xmlstringEmpList += "<cell><![CDATA[" + Job.JobID + "]]></cell>";

                        if (Job.CallCompleted != null) {
                            xmlstringEmpList += "<cell><![CDATA[" + new Date(parseInt(Job.CallCompleted.substr(6))) + "]]></cell>";
                        } else {
                            xmlstringEmpList += "<cell>N/A</cell>";
                        }

                        xmlstringEmpList += "</row>";
                    });
                    xmlstringEmpList += "</rows>";

                    gridEmpList.clearAll();
                    gridEmpList.loadXMLString(xmlstringEmpList);

                },
                type: "POST",
                dataType: "json",
                error: function (e) {
                }
            });

            var previous = document.getElementById("MemberType").value;
        }

    </script>

</head>
<body onload="doOnLoad();">
@*<div style="background-color: #dfedf3">*@
    <div style="background-color: #2C2D31; height: 30px; width: 100%">
        <div style="float: left; padding-right: 30px; padding-left: 10px; height: 30px;">
            <a href="../../../LandingPage/Dashboard" style="border: none">
                <img style="border: none" src="../../../../Images/ConnectusPro logo CMYK 2.png" width="150px" alt="Connectus Pro" height="30px" />
            </a>
        </div>
        
        <div style="padding-left: 30px; padding-top: 5px; vertical-align: middle;">
            <form name="myform" action="CustomerInformation">
            @*@Html.DropDownList("ddlCompanyInfo", new SelectList(ViewBag.frenchise, "FranchiseID", "FranchiseNUmber", ViewBag.FranchiseeId), new { onchange = "changeFranchise()" })*@
            </form>
        </div>
    </div>
    @{Html.BeginForm("CustomerInformation", "AllCustomers");}
    @Html.Hidden("hdnCustId", (Int32)Model.CustomerID)
    <div style="height: 30px; width: 100%; margin-top: 5px;">
        @Html.ActionLink("Back to Search Results", "CustomerList", "AllCustomers", new { isResult = "true" }, new { style = "float:left;margin-top:3px;" })
        <input type="button" id="editbutton" value="Edit" style="background-color: #add8e4; float: right; margin-right: 5px; width: 58px;" />
        <input type="button" id="cancelbutton" value="Cancel" style="background-color: #add8e4; float: right; margin-right: 5px; width: 58px; display: none;" />
        <input type="button" id="savebutton" value="Save" style="background-color: #add8e4; float: right; margin-right: 5px; width: 58px; display: none;" />
    </div>   

    <div>		
        <table width="100%" style="background-color: #dfedf3">
            @*<tr style="background-color: #dfedf3">
                <td>
                    <label style="font-size: larger; font-weight: bold;">
                        Customer History</label>
                </td>
            </tr>*@
            <tr style="background-color: #dfedf3">
                <td>
                    @*Tab Bar Starts*@
                    <div id="a_tabbar" class="dhtmlxTabBar" imgpath="../../../../codebase/imgs/" style="width: 100%; height: 900px;" select="currentinfo">
                        <div id="currentinfo" name="Current Information" style="height: 100%">
                                <table width="100%" style="background-color: #dfedf3">
                                    <tr>
                                        <td style="width: 50%; background: none repeat scroll 0% 0% rgb(223, 237, 243); vertical-align: top;">
                                            @*@Html.DropDownList("ddlCompanyInfoIn", new SelectList(ViewBag.frenchise, "FranchiseID", "FranchiseNUmber", ViewBag.FranchiseeId), new { style = "display:none" })*@
                                            <table width="90%">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Customer Information</label>
                                                        @Html.DropDownList("ddlServiceStatus", (List<SelectListItem>)(Model.ServiceStatus), new { style = "float:right;" })
                                                        <label style="float: right; margin-right: 5px;">
                                                            Service Status</label>
                                                    </td>
                                                </tr>
                                                <tr  style="background-color: Transparent;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                             <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Name</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("Name", Model.customerinfo.CustomerName, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Company Name</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("ComName", Model.customerinfo.CompanyName, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Primary Phone Number</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("PhoneNumber", Model.customerinfo.PrimaryPhone, new { style = "width:150px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Cell Phone Number</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("CellNumber", Model.customerinfo.CellPhone, new { style = "width:150px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Email</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("Email", Model.customerinfo.EMail, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td valign="top">
                                                                    <label>
                                                                        General Notes and Comments</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextArea("GeneralNotes", Model.customerinfo.Notes, new { style = "width:280px;height:60px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table width="100%">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Location Address</label>
                                                    </td>
                                                </tr>
                                                <tr style="background-color: White;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                            <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Address</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("Address", Model.customerinfo.Address, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        City</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("City", Model.customerinfo.City, new { style = "width:140px;", @readonly = "readonly" })
                                                                    <label style="margin-left: 50px; margin-right: 7px;">
                                                                        State</label>
                                                                    @Html.TextBox("State", Model.customerinfo.State, new { style = "width:40px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Zip Code</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("ZipCode", Model.customerinfo.PostalCode, new { style = "width:150px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table width="100%">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Billing Address</label>
                                                    </td>
                                                </tr>
                                                <tr style="background-color: White;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                            <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Name</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("BName", Model.billaddr.CustomerName, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Company</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("BCompany", Model.billaddr.CompanyName, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Address</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("BAddress", Model.billaddr.Address, new { style = "width:280px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        City</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("BCity", Model.billaddr.City, new { style = "width:250px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        State, Postal</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("BState", Model.billaddr.State, new { style = "width:37px;", @readonly = "readonly" })
                                                                    @Html.TextBox("BPostal", Model.billaddr.PostalCode, new { style = "width:77px;margin-left:10px;", @readonly = "readonly" })
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table width="90%" style="margin-top: 5px;">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Job History</label>
                                                    </td>
                                                </tr>
                                                <tr style="background-color: White;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                            <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Date of Next Job</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.jobhistory.DateNextJob != null)
                                                                    {
                                                                        @Html.TextBox("DateNextJob", Model.jobhistory.DateNextJob, new { style = "width:150px;", @disabled = "disabled" })
                                                                    }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("DateNextJob", "", new { style = "width:150px;", @disabled = "disabled" })
                                                                    }
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Date of Last Job</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.jobhistory.DateLastJob != null)
                                                                    {
                                                                        @Html.TextBox("DateLastJob", Model.jobhistory.DateLastJob, new { style = "width:150px;", @disabled = "disabled" })
                                                                    }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("DateLastJob", "", new { style = "width:150px;", @disabled = "disabled" })
                                                                    }
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Total Jobs Completed</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.jobhistory.TotalJobs != null)
                                                                    {
                                                                        @Html.TextBox("TotalJobs", Model.jobhistory.TotalJobs, new { style = "width:150px;", @disabled = "disabled" })
                                                                    }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("TotalJobs", "", new { style = "width:150px;", @disabled = "disabled" })
                                                                    }
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <!-- <td style="width: 50%; background: none repeat scroll 0% 0% rgb(223, 237, 243); vertical-align: top;">
                <table width="100%">
                    <tr style="background-color: #dfedf3">
                        <td>
                            <label style="font-size: larger; font-weight: bold;">Service Plan Information</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <table width="100%" style="margin-top: 5px;">
                                @* <tr>
                                    <td style="width: 40%">
                                        <label>Service Member (Yes/No)</label>
                                    </td>
                                    <td>
                                        @Html.TextBox("ServiceMember", (string)ViewBag.ServiceMember, new { style = "width:280px;",@disabled = "disabled" })
                                    </td>
                                </tr>*@
                                <tr>
                                    <td style="width: 40%">
                                        <label>Membership Plan Type</label>
                                    </td>
                                    <td>
                                        @Html.DropDownList("MemberType", (SelectList)Model.serviceplan.MemberTypeList, "No Membership", new { style = "width:280px;", @disabled = "disabled" })
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Start Date</label>
                                    </td>
                                    <td>
                                        @if (Model.serviceplan.StartDate != null)
                                        {
                                            @Html.TextBox("StartDate", Model.serviceplan.StartDate, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
                                            @Html.TextBox("StartDate", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Expiration Date</label>
                                    </td>
                                    <td>
                                        @if (Model.serviceplan.ExpiryDate != null)
                                        {
                                            @Html.TextBox("ExpiryDate", Model.serviceplan.ExpiryDate, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
                                            @Html.TextBox("ExpiryDate", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Service Visits Performed</label>
                                    </td>
                                    <td>
                                        @if (Model.serviceplan.ServiceVisits != null)
                                        {
                                            @Html.TextBox("ServiceVisits", Model.serviceplan.ServiceVisits, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
                                            @Html.TextBox("ServiceVisits", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Credit Card Expiration Date</label>
                                    </td>
                                    <td>
                                        @if (Model.serviceplan.ServiceVisits != null)
                                        {
                                            @Html.TextBox("CCExpiryDate", Model.serviceplan.CreditCardExpiryDate, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
                                            @Html.TextBox("CCExpiryDate", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <table width="100%;" style="margin-top: 5px;">
                    <tr style="background-color: #dfedf3">
                        <td>
                            <label style="font-size: larger; font-weight: bold;">Opportunity Information</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <table width="100%" style="margin-top: 5px;">
                                <tr>
                                    <td style="width: 40%">
                                        <label>Age of Home</label>
                                    </td>
                                    <td>
                                        @Html.TextBox("AgeofHome", Model.oppinfo.AgeHome, new { style = "width:60px;", @disabled = "disabled" })
                                        Years
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Age of Heating/Cooling System</label>
                                    </td>
                                    <td>
                                        @Html.TextBox("AgeofSystem", Model.oppinfo.AgeSystem, new { style = "width:60px;", @disabled = "disabled" })
                                        Years
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>Age of Water Heater</label>
                                    </td>
                                    <td>
                                        @Html.TextBox("AgeofHeater", Model.oppinfo.AgeHeater, new { style = "width:60px;", @disabled = "disabled" })
                                        Years
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
				<table width="100%">
				    <tr style="background-color: #dfedf3">
					    <td>
						    <label style="font-size: larger; font-weight: bold;">Billing Address</label>
					    </td>
				    </tr>
				    <tr>
					    <td>
						    <table width="100%" style="margin-top: 5px;">
@*							    <tr>
								    <td style="width: 40%">
									    <label>Name</label>
								    </td>
								    <td>
									    @Html.TextBox("BName", Model.billaddr.CustomerName, new { style = "width:280px;", @readonly = "readonly" })
								    </td>
							    </tr>*@
@*							    <tr>
								    <td>
									    <label>Company</label>
								    </td>
								    <td>
									    @Html.TextBox("BCompany", Model.billaddr.CompanyName, new { style = "width:280px;", @readonly = "readonly" })
								    </td>
							    </tr>*@
							    <tr>
								    <td style="width: 40%">
									    <label>Address</label>
								    </td>
								    <td>
									    @Html.TextBox("BAddress", Model.billaddr.Address, new { style = "width:280px;", @readonly = "readonly" })
								    </td>
							    </tr>
							    <tr>
								    <td>
									    <label>City</label>
								    </td>
								    <td>
									    @Html.TextBox("BCity", Model.billaddr.City, new { style = "width:250px;", @readonly = "readonly" })
								    </td>
							    </tr>
							    <tr>
								    <td>
									    <label>State, Postal</label>
								    </td>
								    <td>
									    @Html.TextBox("BState", Model.billaddr.State, new { style = "width:37px;", @readonly = "readonly" })
									    @Html.TextBox("BPostal", Model.billaddr.PostalCode, new { style = "width:77px;margin-left:10px;", @readonly = "readonly" })
								    </td>
							    </tr>
						    </table>
					    </td>
				    </tr>
			    </table>
				<table width="90%" style="margin-top: 5px;">
					<tr style="background-color: #dfedf3">
						<td>
							<label style="font-size: larger; font-weight: bold;">Job History</label>
						</td>
					</tr>
					<tr>
						<td>
							<table width="100%" style="margin-top: 5px;">
								<tr>
									<td style="width: 40%">
										<label>Date of Next Job</label>
									</td>
									<td>
										@if (Model.jobhistory.DateNextJob != null)
                                        {
											@Html.TextBox("DateNextJob", Model.jobhistory.DateNextJob, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
											@Html.TextBox("DateNextJob", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
									</td>
								</tr>
								<tr>
									<td>
										<label>Date of Last Job</label>
									</td>
									<td>
										@if (Model.jobhistory.DateLastJob != null)
                                        {
											@Html.TextBox("DateLastJob", Model.jobhistory.DateLastJob, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
											@Html.TextBox("DateLastJob", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
									</td>
								</tr>
								<tr>
									<td>
										<label>Total Jobs Completed</label>
									</td>
									<td>
										@if (Model.jobhistory.TotalJobs != null)
                                        {
											@Html.TextBox("TotalJobs", Model.jobhistory.TotalJobs, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                        else
                                        {
											@Html.TextBox("TotalJobs", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
				
			</td> -->
                                        <td style="width: 50%; background: none repeat scroll 0% 0% rgb(223, 237, 243); vertical-align: top;">
                                            <table width="100%">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Service Plan Information</label>
                                                    </td>
                                                </tr>
                                                <tr style="background-color: White;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                            @* <tr>
									<td style="width: 40%">
										<label>Service Member (Yes/No)</label>
									</td>
									<td>
										@Html.TextBox("ServiceMember", (string)ViewBag.ServiceMember, new { style = "width:280px;",@disabled = "disabled" })
									</td>
								</tr>*@
                                                            <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Membership Plan Type</label>
                                                                </td>
                                                                <td>
                                                                    @Html.DropDownList("MemberType", (SelectList)Model.serviceplan.MemberTypeList, "No Membership", new { style = "width:280px;", @disabled = "disabled" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Start Date</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.serviceplan.StartDate != null)
                                                                    {
                                                                        @Html.TextBox("StartDate", Model.serviceplan.StartDate, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("StartDate", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Expiration Date</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.serviceplan.ExpiryDate != null)
                                                                    {
                                                                        @Html.TextBox("ExpiryDate", Model.serviceplan.ExpiryDate, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("ExpiryDate", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Service Visits Performed</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.serviceplan.ServiceVisits != null)
                                                                    {
                                                                        @Html.TextBox("ServiceVisits", Model.serviceplan.ServiceVisits, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("ServiceVisits", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Credit Card Expiration Date</label>
                                                                </td>
                                                                <td>
                                                                    @if (Model.serviceplan.ServiceVisits != null)
                                                                    {
                                                                        @Html.TextBox("CCExpiryDate", Model.serviceplan.CreditCardExpiryDate, new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                    else
                                                                    {
                                                                        @Html.TextBox("CCExpiryDate", "", new { style = "width:150px;", @disabled = "disabled" })
                                        }
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table width="100%;" style="margin-top: 5px;">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Opportunity Information</label>
                                                    </td>
                                                </tr>
                                                <tr style="background-color: White;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                            <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Age of Home</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("AgeofHome", Model.oppinfo.AgeHome, new { style = "width:60px;", @disabled = "disabled" })
                                                                    Years
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Age of Heating/Cooling System</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("AgeofSystem", Model.oppinfo.AgeSystem, new { style = "width:60px;", @disabled = "disabled" })
                                                                    Years
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td>
                                                                    <label>
                                                                        Age of Water Heater</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("AgeofHeater", Model.oppinfo.AgeHeater, new { style = "width:60px;", @disabled = "disabled" })
                                                                    Years
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table width="90%" style="margin-top: 5px;">
                                                <tr style="background-color: #dfedf3">
                                                    <td>
                                                        <label style="font-size: larger; font-weight: bold;">
                                                            Financial Data</label>
                                                    </td>
                                                </tr>
                                                <tr style="background-color: White;">
                                                    <td>
                                                        <table width="100%" style="margin-top: 5px;">
                                                            <tr style="background-color: White;">
                                                                <td style="width: 40%">
                                                                    <label>
                                                                        Current Balance</label>
                                                                </td>
                                                                <td>
                                                                    @Html.TextBox("CurrentBalance", Model.financedata.Balance, new { style = "width:280px;", @disabled = "disabled" })
                                                                </td>
                                                            </tr>
                                                            <tr style="background-color: White;">
                                                                <td valign="top">
                                                                    <label>
                                                                        Invoice Numbers</label>
                                                                </td>
                                                                <td>
                                                                    <div id="grdInvoiceNumbers" style="height: 314px; width: 450px">
                                                                        @*@Html.TextArea("InvoiceNumbers", (string)ViewBag.InvoiceNumbers, new { style = "width:280px;height:90px;",@disabled = "disabled" })*@
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                        </div>
                        <div id="customerhistory" name="Customer History" style="height: 100%">
                            @*<div class="div">*@
                                @Html.Partial("../Shared/CustomerHistoryList")
                            @*</div>*@
                        </div>
                    </div>
                    @*Tab Bar Ends*@
                </td>
            </tr>
        </table>
    </div>

	<table style="margin-top: -5px;">
		<tr>
			<td style="width: 50%; background: none repeat scroll 0% 0% rgb(223, 237, 243);">
			</td>
			<td style="width: 50%; background: none repeat scroll 0% 0% rgb(223, 237, 243);"
				valign="top">
			</td>
		</tr>
	</table>
	@{Html.EndForm();}
@*</div>*@
</body>
</html>
